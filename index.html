<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Â¡Feliz CumpleaÃ±os, Hennys!</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            background: linear-gradient(to bottom, #b3e5fc, #e0f7fa);
            font-family: 'Roboto', sans-serif;
            color: #001f3f;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            box-sizing: border-box;
        }
        h1 {
            font-size: 2.8rem;
            color: #007bff;
            margin-bottom: 10px;
        }
        p.intro {
            font-size: 1.3rem;
            max-width: 90%;
            margin-bottom: 40px;
        }
        #game {
            width: 100%;
            max-width: 600px;
        }
        #ciphertext {
            background: rgba(255, 255, 255, 0.8);
            padding: 30px;
            border-radius: 20px;
            font-size: 1.5rem;
            line-height: 2.2;
            margin: 30px 0;
            min-height: 200px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            opacity: 1;
            transition: opacity 0.4s ease;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        label {
            font-size: 1.4rem;
            margin: 20px 0 10px;
            display: block;
        }
        #shift {
            width: 90%;
            height: 40px;
            margin: 20px auto;
            display: block;
        }
        #final {
            display: none;
            width: 100%;
            max-width: 600px;
        }
        #final h2 {
            font-size: 2.5rem;
            color: #007bff;
            margin-bottom: 40px;
        }
        #poem {
            font-family: 'Dancing Script', cursive;
            font-size: 2.2rem;
            line-height: 2.4;
            color: #001f3f;
            margin: 40px 0;
            text-align: center;
        }
        .signature {
            font-style: italic;
            font-size: 1.6rem;
            margin-top: 60px;
            text-align: right;
        }
    </style>
</head>
<body>
    <h1>Â¡Feliz CumpleaÃ±os, Hennys! ðŸ’™</h1>
    <p class="intro"> Hay algo muy especial escondido, espero que te guste...<br>Gira el deslizador para descifrarlo...</p>

    <div id="game">
        <pre id="ciphertext"></pre>
        <label for="shift">Desplazamiento: <span id="shiftValue">0</span></label>
        <input type="range" id="shift" min="0" max="25" value="0">
    </div>

    <div id="final">
        <h2>Â¡Lo conseguiste! ðŸŽ‰</h2>
        <div id="poem"></div>
        <p class="signature">Con todo mi cariÃ±o,<br>Silver</p>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
    <script>
        const original = `Al alba de este aÃ±o,
el sol despereza su luz,
brillando como nunca,
un susurro en el aire.
No hay cartillas que expresen
la emociÃ³n que danza
en el umbral de mis ojos,
ni sombrillas que frenen
las lÃ¡grimas que brotan
de un amor sincero.
Hoy celebro tu ser,
firmeza y bondad,
humanidad iluminada,
hermana del alma.
En mis plegarias,
te envuelvo,
pidiendo que tus sueÃ±os
se dibujen en la bruma del maÃ±ana.
Aunque el camino
pueda doler,
la esperanza empieza
con un paso incierto,
ya que siempre florece
despuÃ©s de la tormenta.`;

        const shiftAmount = 13;

        function caesar(text, shift) {
            return text.split('').map(char => {
                if (char.match(/[a-z]/i)) {
                    const code = char.charCodeAt(0);
                    const base = code >= 65 && code <= 90 ? 65 : 97;
                    return String.fromCharCode(((code - base + shift) % 26) + base);
                }
                return char;
            }).join('');
        }

        const encrypted = caesar(original, shiftAmount);

        const ciphertextEl = document.getElementById('ciphertext');
        const shiftInput = document.getElementById('shift');
        const shiftValue = document.getElementById('shiftValue');
        const game = document.getElementById('game');
        const finalSection = document.getElementById('final');
        const poemEl = document.getElementById('poem');

        let won = false;

        function updateText() {
            if (won) return;

            const currentShift = parseInt(shiftInput.value);
            shiftValue.textContent = currentShift;

            const decrypted = caesar(encrypted, currentShift);

            // Fade animation
            ciphertextEl.style.opacity = 0;
            setTimeout(() => {
                ciphertextEl.textContent = decrypted;
                ciphertextEl.style.opacity = 1;

                if (decrypted === original && !won) {
                    won = true;
                    setTimeout(triggerWin, 800);
                }
            }, 400);
        }

        function triggerWin() {
            game.style.display = 'none';
            finalSection.style.display = 'block';
            poemEl.textContent = original;

            // Confeti explosiÃ³n
            const burst = () => {
                confetti({
                    particleCount: 150,
                    spread: 80,
                    origin: { y: 0.6 },
                    colors: ['#81d4fa', '#b3e5fc', '#007bff', '#ffffff', '#e0f7fa']
                });
            };
            burst();
            setTimeout(burst, 500);
            setTimeout(burst, 1000);
            setTimeout(() => confetti({ particleCount: 80, angle: 60, spread: 55, origin: { x: 0 } }), 300);
            setTimeout(() => confetti({ particleCount: 80, angle: 120, spread: 55, origin: { x: 1 } }), 600);
        }

        // Inicial
        ciphertextEl.textContent = encrypted;
        shiftInput.oninput = updateText;
    </script>
</body>
</html>